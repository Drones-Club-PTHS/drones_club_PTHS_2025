# Блок 3. Полёт по квадрату. (Заметки)

## Системы координат
Система координат дрона изображена ниже на картинке (`X` -- вправо, `Y` -- вперёд, `Z` -- вверх, `yaw` -- против часовой стрелки). При полёте по оптическому потоку связанная с полом система координат фиксируется в момент взлёта, то есть начало координат -- место взлёта, а оси направлены так, как у дрона во время старта.

<img style="display: block; margin: 0 auto" src="./Images/Drone_axes.png" width="500em">

## Команды полёта в точку
```python
go_to_local_point(x, y, z, yaw)  # В системе отчёта, связанной с местом взлёта
go_to_local_point_body_fixed(x, y, z, yaw)  # В системе отсчёта дрона (относительно его текущего положения)
# x, y, z -- в метрах
# yaw -- в радианах
```

Обе функции полёта в точку неблокирующие. Это значит, что вызванный метод `go_to_local_point()` завершится тогда, когда дрон пришлёт ответ, что тот принял команду и готов лететь. Но ожидание прилёта в точку в выполнение этих методов не входит.

> ***В Версии прошивки `9202` в функции `go_to_local_point()` есть баг: не работает поворот.***

[Документация. `go_to_local_point`](https://docs.geoscan.ru/pioneer/programming/python/pioneer-sdk-methods.html#go_to_local_point)\
[Документация. `go_to_local_point_body_fixed`](https://docs.geoscan.ru/pioneer/programming/python/pioneer-sdk-methods.html#go_to_local_point_body_fixed)

## Ожидание прилёта в точку
```python
drone.point_reached()
# false, если ещё не долетел
# true, если долетел (true возвращается один раз на точку)
```
Метод `point_reached()` возвращает `True` или `False`. Вызванный после достижения очередной точки `point_reached()` вернёт `True` однократно, повторные вызовы будут возвращать `False`. Так же флаг сбрасывается в `False` при отправке нового задания полёта в точку.

Пример ожидания прилёта в точку:
```python
drone.go_to_local_point(x, y, z, yaw)
while not drone.point_reached():
    pass
```
[Документация. `point_reached`](https://docs.geoscan.ru/pioneer/programming/python/pioneer-sdk-methods.html#point_reached)
